# Frontend System Design: Google Sheets

## ğŸ“‹ Ğ’Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ

Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ° ÑƒÑ€Ğ¾Ğº Ğ¿Ğ¾ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ğ¾Ğ¼Ñƒ Ğ´Ğ¸Ğ·Ğ°Ğ¹Ğ½Ñƒ Google Sheets Ñ Ñ„Ğ¾ĞºÑƒÑĞ¾Ğ¼ Ğ½Ğ° UI Ğ¿ĞµÑ€ÑĞ¿ĞµĞºÑ‚Ğ¸Ğ²Ñƒ, Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹ Ğ¼ĞµĞ¶Ğ´Ñƒ ÑÑ‡ĞµĞ¹ĞºĞ°Ğ¼Ğ¸ Ğ¸ Ğ²Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ğ´Ğ°Ñ‚Ğ°ÑĞµÑ‚Ğ¾Ğ².

**Ğ§Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ Google Sheets:**
- Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° ÑĞ»ĞµĞºÑ‚Ñ€Ğ¾Ğ½Ğ½Ñ‹Ñ… Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†
- Data analysis, financial planning, budget tracking
- Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ñ‹: `=A1+B1`, Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ ÑÑ‡ĞµĞ¹ĞºĞ°Ğ¼Ğ¸
- Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ: bold, italic, strikethrough
- Ğ¢Ğ¸Ğ¿Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…: date, number, string, custom

---

## ğŸ“ ĞŸĞ»Ğ°Ğ½ System Design

1. âœ… **ĞĞ±Ñ‰Ğ¸Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ**
2. âœ… **Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ**
3. âœ… **Fundamental Design Approach** (Canvas vs DOM)
4. âœ… **ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²**
5. âœ… **Virtualization Design** â­
6. âœ… **Formula Parsing & Dependencies** â­
7. âœ… **State Management**
8. âœ… **ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ**
9. âœ… **Accessibility**

---

## 1. ğŸ“Œ ĞĞ±Ñ‰Ğ¸Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

**1. CRUD Operations**
```
âœ… Create spreadsheet
âœ… Save spreadsheet
âœ… Edit spreadsheet
```

**2. Formatting**
```
âœ… Bold, Italic, Strikethrough
âœ… Generic system (Ğ»ĞµĞ³ĞºĞ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑÑ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ñ‚Ğ¸Ğ¿Ñ‹)
```

**3. Large Spreadsheet Size**
```
Default: 1000 rows Ã— 26 columns = 26,000 cells
Ğ”Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ
```

**4. Formula Parsing â­**
```
âœ… Cell references (=A1+B1)
âœ… Dependencies (A1 â†’ B1 â†’ C1)
âœ… Complex formulas
```

**5. Column/Row Resizing**
```
âœ… Change width/height dynamically
```

---

## 2. ğŸ¯ Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

**1. Multi-platform**
```
âœ… Tablets, phones, laptops, desktops
```

**2. Performance â€” ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ! â­**
```
Ğ”Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ¾Ñ‰ÑƒÑ‰Ğ°Ñ‚ÑŒÑÑ ĞºĞ°Ğº offline app
â†’ No loading placeholders
â†’ Instant calculations
```

**3. PWA Mode**
```
Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° offline
Service Workers
```

**4. Excellent DOM Performance**
```
Large datasets â†’ Virtualization Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ°
```

**5. State Management**
```
Efficient storage
Fast cell access
```

**6. Accessibility**
```
Screen readers
Keyboard navigation
```

---

## 3. ğŸ¨ Fundamental Design Approach â€” ĞšĞ›Ğ®Ğ§Ğ•Ğ’ĞĞ™ Ğ’Ğ«Ğ‘ĞĞ !

### Canvas vs DOM â€” Trade-offs

#### A. Canvas Approach

**Pros:**
```
âœ… GPU-accelerated rendering
âœ… Better performance (ÑˆĞ¸Ñ€Ğ¾ĞºĞ¸Ğ¹ ÑĞ¿ĞµĞºÑ‚Ñ€ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²)
âœ… Best FPS
âœ… No DOM overhead
```

**Cons:**
```
âŒ Completely different methodology
âŒ Need abstraction library over canvas primitives
âŒ Specific engineering skills required
âŒ More expensive development
âŒ Longer onboarding time
âŒ Accessibility = real challenge (mix DOM + Canvas)
```

---

#### B. DOM Approach â­ Ğ’Ğ«Ğ‘ĞĞ 

**Pros:**
```
âœ… Easy to develop (standard)
âœ… Any engineer can work
âœ… Accessibility much easier
âœ… Cheaper development
âœ… Faster time-to-market
```

**Cons:**
```
âŒ Performance affected (large DOM = memory + CPU)
âŒ Virtualization complex (vertical + horizontal)
```

---

### ğŸ† Decision: DOM Elements

**ĞĞ±Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:**
```
Canvas:
â†’ Industry solution
â†’ Millions of users
â†’ Company has resources
â†’ Long-term investment

DOM:
â†’ Internal tool
â†’ Limited functions
â†’ Cost-effective
â†’ Faster development
â†’ Most engineers can work
```

**Ğ”Ğ»Ñ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ´Ğ¸Ğ·Ğ°Ğ¹Ğ½Ğ°: DOM approach**

---

## 4. ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²

### High-Level Hierarchy:

```
SheetApp (root)
â””â”€â”€ TableEditor
    â”œâ”€â”€ ControlPanel
    â”‚   â””â”€â”€ Formatting buttons, functions
    â””â”€â”€ CellGrid
        â”œâ”€â”€ RowCounter (A, B, C...)
        â”œâ”€â”€ ColumnCounter (1, 2, 3...)
        â””â”€â”€ Rows Ã— N
            â””â”€â”€ Cells Ã— N
```

**Layout:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Control Panel]                    â”‚ â† Formatting
â”œâ”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ A â”‚ B  â”‚ C  â”‚ D  â”‚ E  â”‚ F  â”‚       â”‚ â† Columns
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1 â”‚    â”‚    â”‚    â”‚    â”‚    â”‚       â”‚ â† Rows
â”‚ 2 â”‚    â”‚=A1 â”‚    â”‚    â”‚    â”‚       â”‚
â”‚ 3 â”‚    â”‚+B1 â”‚    â”‚    â”‚    â”‚       â”‚
â”‚...â”‚    â”‚    â”‚    â”‚    â”‚    â”‚       â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
    â†‘                            â†‘
Vertical virtualization    Horizontal
    needed                virtualization
                          NOT needed
```

---

## 5. â™¾ï¸ Virtualization Design â€” ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ! â­

### Analysis: Vertical vs Horizontal

**Problem:**
```
1000 rows Ã— 26 columns = 26,000 DOM elements
â†’ Performance nightmare!
```

**Decision:**
```
Vertical Virtualization: âœ… REQUIRED
â†’ Rows can be 10,000+
â†’ Critical for performance

Horizontal Virtualization: âŒ NOT REQUIRED
â†’ 26 columns = default (A-Z)
â†’ ĞœĞ¾Ğ¶Ğ½Ğ¾ Ñ€Ğ°ÑÑˆĞ¸Ñ€Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ 72-78 (AAZ)
â†’ Constraint: Max 200 columns
â†’ Simplifies design significantly!
```

---

### Page Size Constants

```typescript
const PAGE_SIZE = {
  phone: 50,
  tablet: 100,
  laptop: 140,
  desktop: 150,
  largeDesktop: 200
};

const LIMIT = PAGE_SIZE * 2; // Buffer!
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ buffer:**
```
Page size = 50
Limit = 100 (2 Ã— page size)

Ğ‘ĞµĞ· buffer:
- Load 50 â†’ Remove old 50
- User Ğ²Ğ¸Ğ´Ğ¸Ñ‚ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
- Bad UX!

Ğ¡ buffer:
- Load 50 new â†’ Keep 50 old as buffer
- Reuse buffer elements
- Smooth UX!
```

---

### Virtualization Setup

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Top Intersection Observer   â”‚ â† Trigger: Load previous
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚
â”‚  Viewport (visible rows)    â”‚
â”‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Bottom Intersection Observerâ”‚ â† Trigger: Load next
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Content Height = Total size of all rows
â†’ Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ ÑĞºÑ€Ğ¾Ğ»Ğ»Ğµ
```

**ĞšĞ»ÑÑ‡ĞµĞ²Ğ¾Ğµ:**
```css
/* Absolute positioning â†’ No reflow! */
.row {
  position: absolute;
  transform: translateY(0); /* CSS transform */
}
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ absolute + transform:**
```
Regular position:
- Change top/left â†’ Reflow!
- Recalculate all dependent elements
- Expensive!

Absolute + Transform:
- Separate stacking context
- Move pixels only
- No reflow!
- GPU-accelerated
```

---

### Virtualization Flow: Scroll Down

**Initial State:**
```
Rows 1-10: Visible âœ…
Limit: 10 (page size Ã— 1)
Content Height: 10 rows
```

**Step 1: Touch Bottom Observer**
```
Load rows 11-20
Rows 1-10: Buffer (not visible, but in DOM)
Rows 11-20: Visible âœ…
Limit: 20 (page size Ã— 2)
Content Height: 20 rows
```

**Step 2: Load 3rd Page (Recycling!)**
```
Problem: Limit reached (20 rows)
Solution: Recycle buffer rows

Actions:
1. Take rows 1-10 (buffer)
2. Update data: row 1 â†’ row 21, row 2 â†’ row 22, etc.
3. Move using CSS transform: translateY(height of 20 rows)
4. Create empty space at top (padding/margin)
5. Update Content Height

Result:
Rows 11-20: Buffer
Rows 21-30: Visible âœ…
DOM nodes: Still 20! (reused)
```

---

### Hard Write vs Soft Write â­

**Hard Write (âŒ Slow):**
```
Remove entire <tr>
Create new <tr>
  Create <td>
    Create text node
Insert to DOM
â†’ Full DOM manipulation
â†’ Reflow!
```

**Soft Write (âœ… Fast):**
```
Keep <tr> and <td>
Update only text node
â†’ Minimal DOM manipulation
â†’ No reflow!
â†’ 10x faster!
```

**Implementation:**
```typescript
// Soft write
row.cells.forEach((cell, index) => {
  const newData = newRowData[index];
  cell.textContent = newData; // Just update text!
});
```

**Reconciliation:**
```
React, Vue, Angular Ğ´ĞµĞ»Ğ°ÑÑ‚ ÑÑ‚Ğ¾ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸
ĞœÑ‹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·ÑƒĞµĞ¼ Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ (framework-agnostic)
```

---

### CSS Transform Ğ´Ğ»Ñ Ğ¿ĞµÑ€ĞµĞ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ

```typescript
// Calculate cumulative height of rows 1-10
const accumulatedHeight = rows.slice(0, 10)
  .reduce((sum, row) => sum + row.height, 0);

// Move rows using transform
recycledRows.forEach(row => {
  row.style.transform = `translateY(${accumulatedHeight}px)`;
});
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:**
```
1. Rows Ğ¿ĞµÑ€ĞµĞ¼ĞµÑ‰ĞµĞ½Ñ‹ (no reflow!)
2. Empty space ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¾ ÑĞ²ĞµÑ€Ñ…Ñƒ
3. Content Height ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ñ‘Ğ½
4. Observers Ğ¿ĞµÑ€ĞµĞ¼ĞµÑ‰ĞµĞ½Ñ‹
5. Smooth scrolling âœ…
```

---

## 6. ğŸ§® Formula Parsing & Dependencies â€” ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ! â­

### Directed Acyclic Graph (DAG)

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»:**
```
C1 = A1 + B1 + D1
A1 = 5
B1 = 10
D1 = E1 * 2
E1 = 3
```

**Ğ“Ñ€Ğ°Ñ„ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹:**
```
    E1 (3)
     â†“
    D1 (6)
     â†“
A1 (5) â†’ C1 (21)
     â†‘
B1 (10)
```

**Ğ¡Ğ²Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°:**
```
âœ… Directed: Edges Ğ¸Ğ¼ĞµÑÑ‚ Ğ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
âœ… Acyclic: ĞĞµÑ‚ Ñ†Ğ¸ĞºĞ»Ğ¾Ğ² (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ)
âœ… Graph: Ğ’ĞµÑ€ÑˆĞ¸Ğ½Ñ‹ (cells) + Ğ Ñ‘Ğ±Ñ€Ğ° (dependencies)
```

**ĞšĞ°Ğº Ğ² npm:**
```
package.json dependencies = DAG
Ğ¢Ğ¾Ñ‡Ğ½Ğ¾ Ñ‚Ğ°Ğº Ğ¶Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Google Sheets!
```

---

### Topological Sort â­ ĞšĞ›Ğ®Ğ§Ğ•Ğ’ĞĞ™ ĞĞ›Ğ“ĞĞ Ğ˜Ğ¢Ğœ

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:**
```
ĞšĞ°ĞºĞ¾Ğ¹ Ğ¿Ğ¾Ñ€ÑĞ´Ğ¾Ğº Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ?
C1 Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ A1, B1, D1
D1 Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ E1
```

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ: Topological Ordering**

**ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ:**
```
For each edge A â†’ B:
Node B appears BEFORE Node A in ordering

Complexity: O(V + E)
V = vertices (cells)
E = edges (dependencies)
```

**ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğº Ğ½Ğ°ÑˆĞµĞ¼Ñƒ Ğ³Ñ€Ğ°Ñ„Ñƒ:**
```
Ğ˜ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğ¹ Ğ³Ñ€Ğ°Ñ„:
E1 â†’ D1 â†’ C1
A1 â†’ C1
B1 â†’ C1

Topological order:
1. E1 (no dependencies)
2. D1 (depends on E1)
3. A1 (no dependencies)
4. B1 (no dependencies)
5. C1 (depends on A1, B1, D1)

ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ: E1 â†’ D1 â†’ A1 â†’ B1 â†’ C1 âœ…
```

---

### Cycle Detection

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ñ†Ğ¸ĞºĞ»Ğ°:**
```
C1 = A1 + B1 + D1
D1 = B1 + C1  â† Ğ¦Ğ¸ĞºĞ»!
```

**Ğ“Ñ€Ğ°Ñ„:**
```
    C1 â†â”€â”
   â†“     â”‚
   D1 â”€â”€â”€â”˜
   
Ğ¦Ğ¸ĞºĞ»: C1 â†’ D1 â†’ C1
```

**ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ:**
```
Topological Sort Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ¾ Ğ½Ğ°Ñ€ÑƒÑˆĞµĞ½Ğ¾:
Node A is parent of Node B
AND
Node A is child of Node B
â†’ CYCLE DETECTED!

Action: Show error to user
```

---

### Formula Parsing Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Input: "=A1+B1*SUM(C1:C10)"   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dependency Resolver Module         â”‚
â”‚  - DFS + Topological Sort           â”‚
â”‚  - Detect cycles                    â”‚
â”‚  - Return execution order           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
          Execution Order:
          C1, C2, ..., C10, A1, B1
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Formula Parser                     â”‚
â”‚  - Tokenize: "A1", "+", "B1", "*"  â”‚
â”‚  - Parse tokens                     â”‚
â”‚  - Execute operations               â”‚
â”‚  - Algorithms: Shunting Yard, etc. â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Function Mapping (Dynamic Import!) â”‚
â”‚                                     â”‚
â”‚  SUM â†’ import('./functions/sum.js') â”‚
â”‚  AVG â†’ import('./functions/avg.js') â”‚
â”‚  IF  â†’ import('./functions/if.js')  â”‚
â”‚                                     â”‚
â”‚  Load only needed functions!        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
          Calculate Result
```

**ĞšĞ»ÑÑ‡ĞµĞ²Ğ°Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**
```javascript
// Dynamic imports
const functionMapping = {
  SUM: () => import('./functions/sum.js'),
  AVERAGE: () => import('./functions/average.js'),
  IF: () => import('./functions/if.js')
};

// Load only when used
if (token === 'SUM') {
  const sumModule = await functionMapping.SUM();
  result = sumModule.default(args);
}
```

**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:**
```
âœ… Load only Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸
âœ… ĞœĞµĞ½ÑŒÑˆĞµ initial bundle size
âœ… Code splitting Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸
```

---

## 7. ğŸ—„ï¸ State Management

### Table State Structure

```typescript
interface TableState {
  // Flattened map: "row-col" â†’ Cell
  cells: Map<string, TableCell>;
}

interface TableCell {
  // User input: "=A1+B1"
  formula: string;
  
  // Calculated result: 15
  calculatedValue: number | string | null;
  
  // Type: date, number, string
  type: CellType;
  
  // Formatting options (ENUM!)
  formatting: FormattingOption[];
}

enum FormattingOption {
  BOLD = 'BOLD',
  ITALIC = 'ITALIC',
  STRIKETHROUGH = 'STRIKETHROUGH',
  // ...
}
```

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ:**

**1. Flattened Map:**
```typescript
// âœ… O(1) access
const cell = state.cells.get(`${row}-${col}`);

// âŒ Nested structure = O(n)
const cell = state[row][col];
```

**2. Enum Ğ´Ğ»Ñ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**
```typescript
// âœ… ĞĞµĞ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ¾Ñ‚ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
formatting: [FormattingOption.BOLD]

// âŒ Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ¾Ñ‚ CSS ĞºĞ»Ğ°ÑÑĞ¾Ğ²
className: 'text-bold' // Ğ§Ñ‚Ğ¾ ĞµÑĞ»Ğ¸ ĞºĞ»Ğ°ÑÑ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑÑ?
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Enum:**
```
Class names Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒÑÑ
â†’ Ğ¡Ñ‚Ğ°Ñ€Ñ‹Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ñ‘Ğ½Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹ ÑĞ»Ğ¾Ğ¼Ğ°ÑÑ‚ÑÑ
â†’ ĞÑƒĞ¶ĞµĞ½ mapping ÑÑ‚Ğ°Ñ€Ñ‹Ñ… â†’ Ğ½Ğ¾Ğ²Ñ‹Ñ… ĞºĞ»Ğ°ÑÑĞ¾Ğ²

Enum ÑÑ‚Ğ°Ğ±Ğ¸Ğ»ĞµĞ½
â†’ ĞœĞµĞ½ÑĞµÑ‚ÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
â†’ Enum Ğ¾ÑÑ‚Ğ°Ñ‘Ñ‚ÑÑ Ñ‚ĞµĞ¼ Ğ¶Ğµ
â†’ Backward compatibility âœ…
```

---

### Event Flow

```
User edits cell
    â†“
Event bubbles to Table root
    â†“
Event Delegation (data-row, data-col)
    â†“
Determine which cell changed
    â†“
Fire onCellChange(row, col)
    â†“
Access state: tableState.cells.get(`${row}-${col}`)
    â†“
Get formula
    â†“
Dependency Resolver (Topological Sort)
    â†“
Formula Parser
    â†“
Execute calculations
    â†“
Update calculatedValue
    â†“
Soft write to DOM (update text only)
```

**Event Delegation:**
```html
<table data-table>
  <tr data-row="1">
    <td data-col="A">5</td>
    <td data-col="B">10</td>
  </tr>
</table>
```

```typescript
table.addEventListener('change', (e) => {
  const cell = e.target.closest('[data-row][data-col]');
  const row = cell.dataset.row;
  const col = cell.dataset.col;
  
  onCellChange(row, col);
});
```

---

## 8. âš¡ ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

### A. Network Performance

**ĞĞµ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ğ¼Ğ¾! (Offline app)**
```
App Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ offline
â†’ Load resources 1 time
â†’ No network optimization needed
â†’ Focus on rendering + JS
```

---

### B. Rendering Performance

**1. Virtualization âœ…**
```
Ğ ĞµÑˆĞµĞ½Ğ¾ Ğ² ÑĞµĞºÑ†Ğ¸Ğ¸ 5
```

**2. Soft Write âœ…**
```
Update text nodes only
No full DOM re-render
```

**3. Absolute Positioning + Transform âœ…**
```
No reflow
GPU-accelerated
```

**4. CSS Naming Convention**
```css
/* âœ… Flat selectors */
.cell { }
.cell--bold { }

/* âŒ Nested */
.table .row .cell .text { }
```

**5. Minification**
```
JS + CSS minified
Obvious, Ğ½Ğ¾ Ğ½ÑƒĞ¶Ğ½Ğ¾ ÑƒĞ¿Ğ¾Ğ¼ÑĞ½ÑƒÑ‚ÑŒ
```

---

### C. JavaScript Performance

**1. Async Calculations â­**
```typescript
// Web Worker Ğ´Ğ»Ñ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğ¹
const worker = new Worker('calculator.worker.js');

worker.postMessage({
  type: 'CALCULATE_DEPENDENCIES',
  cells: cellsData
});

worker.onmessage = (e) => {
  const results = e.data;
  // Lazily update DOM
  updateCells(results);
};
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Web Worker:**
```
Heavy calculations â†’ Block UI thread
Web Worker â†’ Background thread
â†’ UI responsive âœ…
```

**ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ:**
```
âŒ Can't pass DOM nodes
âŒ Can't modify DOM directly
âœ… Can pass data
âœ… Return data back
```

**2. Lazy DOM Updates**
```typescript
// Batch updates
requestAnimationFrame(() => {
  results.forEach(result => {
    updateCell(result.row, result.col, result.value);
  });
});
```

---

## 9. â™¿ Accessibility

### A. HTML5 Semantic Elements â­

**Ğ•ÑĞ»Ğ¸ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾:**
```html
<!-- âœ… Best: Native table -->
<table>
  <thead>
    <tr>
      <th scope="col">A</th>
      <th scope="col">B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>5</td>
      <td>=A1*2</td>
    </tr>
  </tbody>
</table>
```

**Ğ•ÑĞ»Ğ¸ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ½Ğ´ĞµÑ€Ğ¸Ğ½Ğ³:**
```html
<!-- Divs + ARIA -->
<div role="grid">
  <div role="rowgroup">
    <div role="row">
      <div role="columnheader">A</div>
      <div role="columnheader">B</div>
    </div>
  </div>
  <div role="rowgroup">
    <div role="row">
      <div role="gridcell">5</div>
      <div role="gridcell">=A1*2</div>
    </div>
  </div>
</div>
```

**ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ¾:**
```
HTML5 semantics accessible by default
â†’ Use native <table> if possible
â†’ Don't use ARIA if not needed
â†’ ARIA only when divs required
```

---

### B. REMs Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Pixels

```css
/* User custom browser settings */
.cell {
  font-size: 1rem;   /* Scales with zoom */
  padding: 0.5rem;
}
```

---

### C. Keyboard Navigation

```
Shortcuts required:
- Arrow keys: Navigate cells
- Tab: Next cell
- Shift+Tab: Previous cell
- Enter: Edit cell
- Esc: Cancel edit
- Ctrl+C: Copy
- Ctrl+V: Paste
- Ctrl+F: Search
```

---

## ğŸ“Š Ğ˜Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Google Sheets App               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  Rendering: DOM Elements âœ…             â”‚
â”‚  (Not Canvas)                           â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  Virtualization:                        â”‚
â”‚  - Vertical: âœ… Required                â”‚
â”‚  - Horizontal: âŒ Not needed            â”‚
â”‚  - Buffer: 2 Ã— page size                â”‚
â”‚  - Soft write (reuse DOM)               â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  Dependencies:                          â”‚
â”‚  - DAG (Directed Acyclic Graph)         â”‚
â”‚  - Topological Sort â­                  â”‚
â”‚  - Cycle detection                      â”‚
â”‚  - DFS algorithm                        â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  Formula Parsing:                       â”‚
â”‚  - Tokenization                         â”‚
â”‚  - Dynamic function imports             â”‚
â”‚  - Arithmetic operations                â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  State:                                 â”‚
â”‚  - Flattened Map (O(1) access)          â”‚
â”‚  - Enum Ğ´Ğ»Ñ formatting                  â”‚
â”‚  - Minimal state                        â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  Performance:                           â”‚
â”‚  - Web Workers (calculations)           â”‚
â”‚  - Absolute positioning + Transform     â”‚
â”‚  - No reflow                            â”‚
â”‚  - Offline-first                        â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ñ‹

### 1. **DOM vs Canvas â€” Trade-off**
```
Canvas: Performance â†‘, Cost â†‘, Accessibility â†“
DOM: Performance â†“, Cost â†“, Accessibility â†‘

Ğ’Ñ‹Ğ±Ğ¾Ñ€: DOM (cost-effective, standard)
```

### 2. **Virtualization â€” Only Vertical**
```
26,000 cells â†’ Performance problem
Vertical: âœ… (1000+ rows)
Horizontal: âŒ (26-78 columns OK)
â†’ Simplifies design!
```

### 3. **Soft Write > Hard Write**
```
Update text nodes only
â†’ 10x faster
â†’ No reflow
```

### 4. **Topological Sort â­**
```
Dependency resolution
Cycle detection
Execution order
â†’ O(V + E) complexity
```

### 5. **Web Workers Ğ´Ğ»Ñ Ñ‚ÑĞ¶Ñ‘Ğ»Ñ‹Ñ… Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğ¹**
```
Background thread
UI Ğ½Ğµ Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚ÑÑ
Critical Ğ´Ğ»Ñ UX
```

### 6. **Absolute + Transform**
```
No reflow
GPU-accelerated
Smooth scrolling
```

---

**Ğ’Ñ€ĞµĞ¼Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ:** ~60 Ğ¼Ğ¸Ğ½ÑƒÑ‚  
**Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ:** Senior/Staff Frontend Engineer  
**ĞšĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸:** Google, Microsoft, Notion, Airtable

Ğ£Ğ´Ğ°Ñ‡Ğ¸ Ğ½Ğ° Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²ÑŒÑ! ğŸ“ŠğŸš€