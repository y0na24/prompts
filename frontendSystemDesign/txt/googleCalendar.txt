# Frontend System Design: Google Calendar

## ğŸ“‹ Ğ’Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ

Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ° ÑƒÑ€Ğ¾Ğº Ğ¿Ğ¾ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ğ¾Ğ¼Ñƒ Ğ´Ğ¸Ğ·Ğ°Ğ¹Ğ½Ñƒ Google Calendar Ñ Ñ„Ğ¾ĞºÑƒÑĞ¾Ğ¼ Ğ½Ğ° multi-user support, conflict detection Ğ¸ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½ÑƒÑ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ Ñ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸ÑĞ¼Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Interval Tree.

**Ğ§Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ Google Calendar:**
- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹
- ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹
- ĞœĞ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğµ Ğ²Ğ¸Ğ´Ñ‹: Year, Month, Day
- Real-time Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ
- ĞšĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ñ‹ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹

---

## ğŸ“ ĞŸĞ»Ğ°Ğ½ System Design

1. âœ… **ĞĞ±Ñ‰Ğ¸Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ**
2. âœ… **Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ**
3. âœ… **Layout Overview (Year, Month, Day)**
4. âœ… **Component Architecture**
5. âœ… **Data Model** â­
6. âœ… **Interval Tree Ğ´Ğ»Ñ Conflict Detection** â­ ĞšĞ»ÑÑ‡ĞµĞ²Ğ¾Ğµ!
7. âœ… **Data Transferring (Protocol)**
8. âœ… **Rendering Optimization**
9. âœ… **Mobile Bridging**
10. âœ… **Optimization & Accessibility**

---

## 1. ğŸ“Œ ĞĞ±Ñ‰Ğ¸Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

**1. Multiple Views**
```
âœ… Year view (12 Ğ¼ĞµÑÑÑ†ĞµĞ²)
âœ… Month view (Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¼ĞµÑÑÑ†)
âœ… Day view (Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ´Ğ½Ñ)
```

**2. Multi-user Support**
```
âœ… Create events for others
âœ… Invite users
âœ… Receive live updates
```

**3. Event Details**
```
âœ… View event info
âœ… Rich text description
âœ… Participants list
```

**4. Conflict Detection â­**
```
ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ¿ĞµÑ€ĞµÑĞµĞºĞ°ÑÑ‚ÑÑ
â†’ Event 1: 7:00-8:00
â†’ Event 2: 7:30-8:30
â†’ UI Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚!
```

**5. Export/Import**
```
âœ… .ics format support
âœ… Offline calendar integration
```

**6. PWA Mode**
```
âœ… Works offline
âœ… Push reminders
```

---

## 2. ğŸ¯ Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

**1. Mobile First â­**
```
ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ: ĞĞ° Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ…
â†’ Offline capability critical
â†’ Battery efficient
```

**2. Efficient Data Model**
```
ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº
Fast access
Conflict detection
```

**3. Bridge Native Capabilities**
```
Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ:
- Trigger native alarms
- Push notifications
- Deep links
```

**4. Efficient Rendering**
```
Smooth animations
Quick year/month switching
No virtualization (Ğ½Ğµ Ğ½ÑƒĞ¶Ğ½Ğ°!)
```

**5. Accessibility**
```
Screen readers
Keyboard navigation
```

---

## 3. ğŸ“… Layout Overview

### Year View:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2022                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¤
â”‚ Jan   â”‚ Feb   â”‚ Mar   â”‚ Apr   â”‚ ... â”‚
â”‚ 1 2 3 â”‚ 1 2 3 â”‚ 1 2 3 â”‚ 1 2 3 â”‚     â”‚
â”‚ 4 5 6 â”‚ 4 5 6 â”‚ 4 5 6 â”‚ 4 5 6 â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜

Click Ğ½Ğ° Ğ´ĞµĞ½ÑŒ â†’ Event list
```

### Month View:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  June 2022                          â”‚
â”œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¤
â”‚ S â”‚ M â”‚ T â”‚ W â”‚ T â”‚ F â”‚ S â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚   â”‚   â”‚ 1 â”‚ 2 â”‚ 3 â”‚ 4 â”‚ 5 â”‚
â”‚ 6 â”‚ 7 â”‚ 8 â”‚ 9 â”‚10 â”‚11 â”‚12 â”‚
â”‚[Event 1]  â”‚[Event 2]      â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜

Click Ğ½Ğ° Ğ´ĞµĞ½ÑŒ â†’ Event list
```

### Day View:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  June 30, 2022                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 07:00 - 08:00  [Meeting]            â”‚
â”‚ 09:00 - 10:30  [Code Review]        â”‚
â”‚ 12:00 - 13:00  [Lunch]              â”‚
â”‚ 14:00 - 15:00  [Design Review]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Schedule view
```

---

## 4. ğŸ—ï¸ Component Architecture

```
AppRoot
â”œâ”€â”€ CalendarControls
â”‚   â”œâ”€â”€ Create Event
â”‚   â”œâ”€â”€ Search
â”‚   â”œâ”€â”€ Theme Config
â”‚   â””â”€â”€ Language Config
â”œâ”€â”€ CalendarView (3 implementations)
â”‚   â”œâ”€â”€ YearView
â”‚   â”‚   â””â”€â”€ MonthCell Ã— 12
â”‚   â”‚       â””â”€â”€ EventView
â”‚   â”œâ”€â”€ MonthView
â”‚   â”‚   â””â”€â”€ DayCell Ã— 28-31
â”‚   â”‚       â””â”€â”€ EventView
â”‚   â””â”€â”€ DayView
â”‚       â””â”€â”€ EventCell Ã— N
â”‚           â””â”€â”€ EventView
â””â”€â”€ ClientStorage (global state)
```

**EventView:**
```
Generic component Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ
Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ²Ğ¾ Ğ²ÑĞµÑ… 3 view
```

---

## 5. ğŸ“Š Data Model â€” Design Requirements

**Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğº Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸:**

1. **Universal Entity**
```
ĞĞ´Ğ½Ğ° ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ´Ğ»Ñ Ğ²ÑĞµÑ… 3 views
ĞĞµÑ‚ Ğ´ÑƒĞ±Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
```

2. **Serializable**
```
JSON-friendly
Export/Import support
```

3. **Minimal Mutations**
```
CUD operations â†’ mutate only affected data
ĞĞµ Ğ¿ĞµÑ€ĞµÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµĞ¼ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹
ĞœĞµĞ½ÑŒÑˆĞµ CPU load
```

4. **Easy Access**
```
Ideally O(1) access by ID
No search operations
```

5. **Minimal Server Transformation**
```
Server model â‰ˆ Client model
Less processing
```

6. **Conflict Detection Support â­**
```
Detect overlapping events efficiently
Handle multi-month spanning events
```

---

### Data Structures:

```typescript
interface CalendarStore {
  // Flattened map: ID â†’ Event
  events: Map<string, Event>;
  
  // Client UI state
  clientState: {
    selectedView: 'year' | 'month' | 'day';
    language: string;
    timezone: string;
  };
}

interface Event {
  id: string;
  title: string;
  description: string;  // Rich text
  
  // Timestamps!
  startTimestamp: number;
  endTimestamp: number;
  
  // Participants
  participants: UserInfo[];
  
  // Conflict tracking (Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ¼)
  conflictingEvents?: string[];  // Linked list of IDs
}

interface UserInfo {
  email: string;
  firstName?: string;
  lastName?: string;
}
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ timestamps:**
```
âœ… Timezone conversion Ğ»ĞµĞ³ĞºĞ¾
âœ… Ğ¢Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ´Ğ°Ñ‚Ğ° + Ğ²Ñ€ĞµĞ¼Ñ
âœ… ĞœĞ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸ĞºĞ° Ğ¿Ñ€Ğ¾Ñ‰Ğµ
âœ… Universal format
```

---

## 6. ğŸŒ³ Interval Tree â€” ĞšĞ›Ğ®Ğ§Ğ•Ğ’ĞĞ™ ĞĞ›Ğ“ĞĞ Ğ˜Ğ¢Ğœ! â­

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: Conflict Detection

**Scenario:**
```
Event 1: June 11, 2022 â†’ July 11, 2022
Event 2: June 25, 2022 â†’ July 11, 2022

Question: ĞšĞ°ĞºĞ¸Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ½Ğ° June 30?
```

**Naive Solution:**
```typescript
// âŒ O(n) Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ Ğ´Ğ°Ñ‚Ñ‹
function getEventsForDate(date: Date, events: Event[]) {
  return events.filter(event => 
    event.start <= date && event.end >= date
  );
}

// Ğ”Ğ»Ñ Ğ³Ğ¾Ğ´Ğ°: 365 Ã— O(n) = O(365n)
// ĞĞµ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾!
```

**Alternative: Map by Date**
```typescript
// Map: Date â†’ Event[]
map = {
  "2022-06-30": [event1, event2],
  "2022-07-01": [event1, event2],
  // ...
}

// âŒ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹:
// 1. Ğ”ÑƒĞ±Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ: Event Ğ½Ğ° 365 Ğ´Ğ½ĞµĞ¹ = 365 Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹
// 2. Overhead Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
// 3. Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°Ñ‚ÑŒ
```

---

### ğŸ† Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ: Interval Tree

**Ğ§Ñ‚Ğ¾ ÑÑ‚Ğ¾:**
```
Binary Search Tree
ĞšĞ»ÑÑ‡: Start timestamp
Ğ¥Ñ€Ğ°Ğ½Ğ¸Ñ‚: Intervals (start, end)
```

**Complexity:**
```
Search: O(log n)
Insert: O(log n)
Delete: O(log n)

Ğ”Ğ»Ñ Ğ³Ğ¾Ğ´Ğ°: 365 Ã— O(log n) = O(365 log n)
â†’ ĞĞĞœĞĞĞ“Ğ Ğ›Ğ£Ğ§Ğ¨Ğ•!
```

---

### ĞŸĞ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ğµ Interval Tree

**Input Events:**
```
Event 1: Jun 10 - Jun 16
Event 2: Jun 07 - Jun 14
Event 3: Jun 17 - Jun 20
Event 4: Jun 01 - Jun 02
Event 5: Jun 11 - Jul 02
Event 6: Jun 30 - Jul 03
```

**Step 1: Build BST Ğ¿Ğ¾ Start Date**

```
            [Jun 10]
           /        \
      [Jun 07]    [Jun 17]
       /              \
  [Jun 01]         [Jun 30]
                    /
               [Jun 11]
```

**ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ¾:**
```
If newEvent.start < node.start â†’ left
If newEvent.start > node.start â†’ right
```

---

**Step 2: Calculate Max End Date Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ÑƒĞ·Ğ»Ğ°**

```
            [Jun 10, max: Jul 02]
           /                    \
   [Jun 07, max: Jul 02]    [Jun 17, max: Jul 03]
    /                            \
[Jun 01, max: Jun 02]         [Jun 30, max: Jul 03]
                               /
                        [Jun 11, max: Jul 02]
```

**Max Calculation:**
```
node.max = max(
  node.endDate,
  node.left.max,
  node.right.max
)
```

---

### Search Algorithm

**Query: Events Ğ½Ğ° June 23?**

```
Start at root: [Jun 10, max: Jul 02]
    â†“
Check: Jun 23 <= Jul 02? âœ… (Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ² ÑÑ‚Ğ¾Ğ¼ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€ĞµĞ²Ğµ)
    â†“
Check node: Jun 10 <= Jun 23 <= Jun 16? âŒ
    â†“
Go left: [Jun 07, max: Jul 02]
Check: Jun 23 <= Jul 02? âœ…
Check node: Jun 07 <= Jun 23 <= Jun 14? âŒ
    â†“
Go left: [Jun 01, max: Jun 02]
Check: Jun 23 <= Jun 02? âŒ (STOP ÑÑ‚Ğ¾Ğ¹ Ğ²ĞµÑ‚ĞºĞµ)
    â†“
Go right from root: [Jun 17, max: Jul 03]
Check: Jun 23 <= Jul 03? âœ…
Check node: Jun 17 <= Jun 23 <= Jun 20? âŒ
    â†“
Go right: [Jun 30, max: Jul 03]
Check: Jun 30 <= Jul 03? âœ…
Check node: Jun 30 <= Jun 23? âŒ
    â†“
Go left: [Jun 11, max: Jul 02]
Check: Jun 23 <= Jul 02? âœ…
Check node: Jun 11 <= Jun 23 <= Jul 02? âœ… FOUND!

Result: Event 5
```

**ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ¾ Ğ¿Ğ¾Ğ¸ÑĞºĞ°:**
```
1. If target > node.max â†’ STOP (Ğ½ĞµÑ‚ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹)
2. Check if target in [node.start, node.end]
3. Recursively search left and right
```

---

### Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ² Calendar Store

```typescript
interface CalendarStore {
  // Map: ID â†’ Event (O(1) access)
  events: Map<string, Event>;
  
  // Interval Tree Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ°
  eventsTree: IntervalTree<string>;  // Ğ¥Ñ€Ğ°Ğ½Ğ¸Ñ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ IDs!
  
  clientState: ClientState;
}
```

**Event Flow:**

```
New Event from Server
    â†“
Add to events Map (by ID)
    â†“
Insert to Interval Tree (start, end, ID)
    â†“
Render Day View
    â†“
Query Tree: getEventsForDate(June 30)
    â†“
Returns: [id1, id2, id3]
    â†“
Access events Map: events.get(id1)
    â†“
Detect conflicts â†’ Populate conflictingEvents[]
    â†“
Render with conflict indicator
```

**ĞšĞ»ÑÑ‡ĞµĞ²Ğ¾Ğµ:**
```
Tree = Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ°
Map = Ñ„Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

Mutations â†’ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ² Map
Tree â†’ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ insert/delete ID
```

---

## 7. ğŸ”Œ Data Transferring (Protocol)

### Long Polling

**Pros:**
```
âœ… Easy implementation
âœ… Just HTTP request with timeout
```

**Cons:**
```
âŒ High latency (OK Ğ´Ğ»Ñ ĞºĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€Ñ)
âŒ Connection timeouts (proxies, switching cells)
âŒ Traffic overhead (full request headers)
```

---

### WebSockets

**Pros:**
```
âœ… Super fast
âœ… Duplex communication
âœ… Real-time
```

**Cons:**
```
âŒ Keeping connection = expensive
âŒ NOT HTTP/2 compatible
âŒ Hard to load balance
âŒ Overkill Ğ´Ğ»Ñ ĞºĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€Ñ (Ğ½Ğµ Ğ½ÑƒĞ¶ĞµĞ½ real-time)
```

---

### Server-Sent Events (SSE) â­ Ğ’Ğ«Ğ‘ĞĞ 

**Pros:**
```
âœ… HTTP/2 benefits
âœ… Receive only needed data
âœ… Text format (OK)
âœ… Don't waste device resources
âœ… Unidirectional (receive only) â†’ saves battery!
âœ… Easy to load balance
```

**Cons:**
```
âŒ Unidirectional (Ğ½Ğ¾ Ğ½Ğ°Ğ¼ Ğ½Ğµ Ğ½ÑƒĞ¶Ğ½Ğ° Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ñ‡Ğ°ÑÑ‚Ğ¾)
âŒ Weird API
âŒ Text only
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ SSE Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ…:**
```
Duplex antenna (WebSockets):
- Receive + Send active
- More battery drain

Mono antenna (SSE):
- Only receive active
- Less battery drain âœ…
```

---

### GraphQL Ğ½Ğ°Ğ´ SSE â­ Ğ¤Ğ˜ĞĞĞ›Ğ¬ĞĞĞ• Ğ Ğ•Ğ¨Ğ•ĞĞ˜Ğ•

**API Methods:**

```graphql
# Subscription (SSE)
subscription SubscribeEvents {
  subscribeEvents(
    apiKey: String!
    userId: ID!
    timestamp: Int!
    period: Period!  # YEAR, MONTH, DAY
  ) {
    id
    title
    startTimestamp
    endTimestamp
    participants { email }
  }
}

# Query
query GetEventInfo($id: ID!) {
  event(id: $id) {
    id
    title
    description  # Rich text
    participants { email firstName lastName }
    # Full details
  }
}

# Mutations
mutation CreateEvent($input: EventInput!) {
  createEvent(input: $input) { id }
}

mutation UpdateEvent($id: ID!, $input: EventInput!) {
  updateEvent(id: $id, input: $input) { id }
}

mutation DeleteEvent($id: ID!) {
  deleteEvent(id: $id)
}
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ GraphQL:**

```
âœ… High flexibility (select only needed fields)
âœ… Single endpoint
âœ… Subscription = SSE (implementation)
âœ… No need multiple REST endpoints
âœ… Type system out-of-the-box

âŒ Not all GraphQL clients support SSE (need custom implementation)
âŒ No HTTP caching (POST requests)
```

**GraphQL Subscriptions over SSE:**
```
HTTP/2 spec â†’ Server-Sent Events
GraphQL spec â†’ Subscriptions

Implementation:
GraphQL Subscription â†’ SSE transport layer
= Best of both worlds!
```

---

## 8. ğŸ–¼ï¸ Rendering Optimization

### No Virtualization Needed!

```
ĞšĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€ÑŒ:
- Year: 12 months (Ğ¼Ğ°Ğ»Ğ¾)
- Month: 28-31 days (Ğ¼Ğ°Ğ»Ğ¾)
- Day: N events (Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾ < 20)

â†’ Virtualization ĞĞ• Ğ¢Ğ Ğ•Ğ‘Ğ£Ğ•Ğ¢Ğ¡Ğ¯
â†’ Focus Ğ½Ğ° smooth animations
```

---

### Solution 1: Soft Update

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:**
```
ĞŸÑ€Ğ¸ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ³Ğ¾Ğ´Ğ°: 2021 â†’ 2022
â†’ Update Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ text nodes
â†’ Reuse existing DOM
```

**Pros:**
```
âœ… Easy implementation
```

**Cons:**
```
âŒ Re-render takes time
âŒ Fetch data on each switch
âŒ Many requests if user switches often
âŒ Not smooth
```

---

### Solution 2: Pre-rendering â­ Ğ’Ğ«Ğ‘ĞĞ 

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:**
```
Pre-render Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰Ğ¸Ğ¹ Ğ¸ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´
CSS transform Ğ´Ğ»Ñ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
```

**Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2021     â”‚  2022     â”‚  2023     â”‚
â”‚ (hidden)  â”‚ (visible) â”‚ (hidden)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†‘           â†‘           â†‘
translateX  translateX  translateX
  (-100%)      (0%)      (+100%)
```

**User switches to 2023:**

```
CSS Transform Animation:
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2021     â”‚  2022     â”‚  2023     â”‚  2024     â”‚
â”‚           â”‚ (hidden)  â”‚ (visible) â”‚ (hidden)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
translateX  translateX  translateX  translateX
 (-200%)     (-100%)      (0%)      (+100%)
```

**Pre-render Ğ½Ğ¾Ğ²Ñ‹Ğ¹ 2024**

---

**Implementation:**

```typescript
// Max screens in memory
const MAX_SCREENS = 9;

// Current: 2022
// Pre-rendered: 2018, 2019, 2020, 2021, [2022], 2023, 2024, 2025, 2026

// 4 left + current + 4 right
```

**Pros:**
```
âœ… Smooth animations (CSS transform)
âœ… Pre-rendered = instant switch
âœ… Less re-renders
âœ… Better UX
```

**Cons:**
```
âŒ More DOM elements (Ğ½Ğ¾ Ğ½Ğµ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ğ¾)
âŒ Harder implementation (Ğ½Ğ¾ worth it)
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ CSS Transform:**
```
transform: translateX() â†’ paint layer only
â†’ No reflow
â†’ GPU-accelerated
â†’ Smooth 60fps
```

---

## 9. ğŸ“± Mobile Bridging

### Problem: Trigger Native Alarms

**Option 1: Web Push Notifications**

```
Web Push API
â†’ Browser notifications
â†’ Works on mobile + desktop

Requirements:
1. User consent (usually denied)
2. Push server (additional infrastructure)

Cons:
âŒ User must allow
âŒ Additional backend service
```

---

**Option 2: Deep Links â­**

```
Deep Link Format:
alarm://create?time=1234567890&title=Meeting

Native app handles link
â†’ Creates native alarm

Example:
<a href="alarm://create?...">Set Reminder</a>
```

**Requirements:**
```
Native app must:
1. Register URL scheme (alarm://)
2. Handle link
3. Parse parameters
```

**Pros:**
```
âœ… Native integration
âœ… No user consent needed
âœ… No additional servers
```

**Cons:**
```
âŒ Depends on native app implementation
âŒ Not all apps support
```

---

## 10. âš¡ Optimization

### A. Network Performance

**Bundle Splitting:**
```javascript
bundles:
- core.js
- year-view.js (lazy load)
- month-view.js (lazy load)
- day-view.js (lazy load)
- analytics.js (defer)
```

**Compression:**
```
Gzip + Brotli (33% better than Gzip)
```

**Multiple Targets:**
```
ES6 bundle (modern browsers, no polyfills)
ES5 bundle (old browsers, with polyfills)
```

---

### B. Rendering Performance

**1. Pre-rendering âœ…**
```
Ğ ĞµÑˆĞµĞ½Ğ¾ Ğ² ÑĞµĞºÑ†Ğ¸Ğ¸ 8
```

**2. Avoid Reflows**
```css
/* âœ… Transform (no reflow) */
.calendar {
  transform: translateX(-100%);
}

/* âŒ Left (reflow) */
.calendar {
  left: -100%; /* BAD! */
}
```

**3. CSS Animations**
```css
.calendar {
  transition: transform 0.3s ease;
}
```

**4. CSS Naming**
```css
/* Flat selectors */
.calendar__month { }
```

**5. Soft Writes**
```typescript
// Update text only, don't recreate nodes
cell.textContent = newDate;
```

**6. Inline Critical CSS**
```html
<style>
  /* Above-the-fold styles */
</style>
```

**7. Placeholders**
```
Loading state â†’ Skeleton UI
```

---

### C. JavaScript Performance

**1. Minimal Store Mutations**
```typescript
// Only mutate affected data
events.set(id, updatedEvent);
// Don't rebuild entire tree
```

**2. Efficient Data Structure**
```
Interval Tree â†’ O(log n) search
```

**3. Minify + Less Polyfills**
```
ES6 target â†’ smaller bundle
```

---

### D. PWA (Offline)

**Service Workers:**
```typescript
// Cache all resources
self.addEventListener('install', (e) => {
  e.waitUntil(
    caches.open('calendar-v1').then(cache => {
      return cache.addAll([
        '/',
        '/styles.css',
        '/app.js'
      ]);
    })
  );
});
```

---

## 11. â™¿ Accessibility

**1. REMs (not pixels)**
```css
.calendar {
  font-size: 1rem;
}
```

**2. Keyboard Shortcuts**
```
N: Next period
P: Previous period
T: Today
S: Search
H: Help
```

**3. ARIA Attributes**
```html
<div role="grid" aria-label="Calendar">
  <div role="row">
    <div role="gridcell">30</div>
  </div>
</div>
```

**4. HTML5 Semantics**
```html
<table> if possible
Minimize ARIA usage
```

**5. Color Schemes**
```css
/* Color blindness support */
@media (prefers-contrast: high) { }
```

---

## ğŸ“Š Event-Driven Architecture

```
Component
    â†“ Fire Event
EventBus
    â†“ Route Event
EventHandler
    â†“ Async Action
API Call (GraphQL)
    â†“ Response
Update ClientStore
    â†“ Subscribe
Component Re-renders
```

**Implementation:**
```
React: Redux
Vue: Vuex
Angular: NgRx
```

**Flow:**
```
1. AppRoot â†’ init event
2. EventBus â†’ route to handler
3. Handler â†’ subscribeEvents (GraphQL)
4. Update store
5. Components receive data
6. Pass to children (YearView, MonthView, DayView)
7. EventView fires loadEventDetails
8. Cycle repeats
```

---

## ğŸ“ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ñ‹

### 1. **Interval Tree â­**
```
Conflict detection
O(log n) search
365 days Ã— O(log n) = efficient
```

### 2. **SSE + GraphQL**
```
SSE: HTTP/2, battery efficient
GraphQL: Flexible queries, subscriptions
= Perfect combo
```

### 3. **Pre-rendering**
```
4 left + current + 4 right
CSS transform
Smooth animations
```

### 4. **Mobile First**
```
Battery efficient
Offline capable
Deep links
```

### 5. **No Virtualization**
```
ĞœĞ°Ğ»Ğ¾ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
Focus Ğ½Ğ° animations
```

### 6. **Flattened Store**
```
Map: ID â†’ Event (O(1))
Interval Tree: Conflict detection (O(log n))
```

---

**Ğ’Ñ€ĞµĞ¼Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ:** ~60 Ğ¼Ğ¸Ğ½ÑƒÑ‚  
**Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ:** Senior/Staff Frontend Engineer  
**ĞšĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸:** Google, Microsoft, Apple, Notion

Ğ£Ğ´Ğ°Ñ‡Ğ¸ Ğ½Ğ° Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²ÑŒÑ! ğŸ“…ğŸš€