# Frontend System Design: Notion

## ğŸ“‹ Ğ’Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ

Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ° ÑƒÑ€Ğ¾Ğº Ğ¿Ğ¾ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ğ¾Ğ¼Ñƒ Ğ´Ğ¸Ğ·Ğ°Ğ¹Ğ½Ñƒ Notion â€” Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ñ… workspace Ñ Ğ¿Ñ€Ğ¾Ğ´Ğ²Ğ¸Ğ½ÑƒÑ‚Ñ‹Ğ¼ markdown Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¾Ğ¼ Ğ¸ database views.

**Ğ§Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ Notion:**
- Web-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°
- Custom markdown syntax
- Ğ˜ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ† (pages Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ pages)
- Database views: Table, Calendar, Timeline
- Offline-first Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

---

## ğŸ“ ĞŸĞ»Ğ°Ğ½ System Design

1. âœ… **General Requirements**
2. âœ… **Advanced Requirements**
3. âœ… **Mockup & Components Hierarchy**
4. âœ… **Markdown Parser (Lexer)** â­
5. âœ… **Database Design**
6. âœ… **State Design**
7. âœ… **API Design (GraphQL)**
8. âœ… **Optimization**
9. âœ… **Accessibility**

---

## 1. ğŸ“Œ General Requirements

**1. Custom Editor Ñ Live Transformation**
```
User types: ## Hello
â†’ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ² H2
â†’ Real-time preview
```

**2. Extendable Components Library â­**
```
Ğ›ĞµĞ³ĞºĞ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑÑ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
Ğ•Ğ´Ğ¸Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ñ‚Ğ¸Ğ¿Ğ¾Ğ²
```

**3. Page Hierarchy**
```
Pages Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ pages
Workspace = Ğ´ĞµÑ€ĞµĞ²Ğ¾ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†
```

**4. Performance & Accessibility**
```
Desktop-first (Ğ¼ĞµĞ½ÑŒÑˆĞµ network concerns)
Focus Ğ½Ğ° CPU performance
```

---

## 2. ğŸ¯ Advanced Requirements

**1. Databases**
```
Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° pages
Multiple views: Table, Calendar, Timeline
```

**2. Offline-first + Efficient Network**
```
PWA mode
Delta updates (Ğ½Ğµ Ğ²ĞµÑÑŒ page, Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ)
Service Workers
```

**3. Cross-platform + Multi-viewport**
```
Web = ĞºÑ€Ğ¾ÑÑ-Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ
Responsive design
```

---

## 3. ğŸ—ï¸ Mockup & Architecture

### Mockup:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Workspace Hierarchy]  â”‚  Content Area â”‚
â”‚                         â”‚               â”‚
â”‚  ğŸ“„ Page 1              â”‚  # Heading 1  â”‚
â”‚    ğŸ“„ Subpage 1.1       â”‚               â”‚
â”‚    ğŸ“„ Subpage 1.2       â”‚  Paragraph... â”‚
â”‚  ğŸ“„ Page 2              â”‚               â”‚
â”‚  ğŸ“„ Database            â”‚  [Table View] â”‚
â”‚                         â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Components Hierarchy & Data Flow:

```
AppRoot (Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ rootPageId)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   â”‚                     â”‚
ApplicationMenu   ApplicationRouter
(workspace tree)   (SPA routing)
â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
                PageRoot (pageId)
                    â†“
                PageContent
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚
    Static Area          Selected Area
    (cached)            (contenteditable)
        â”‚                       â”‚
        â†“                       â†“
   [Cached HTML]        MutationObserver
                               â†“
                        Detect Changes
                               â†“
                        Global Dispatcher
                               â†“
                        Action Handler
                               â†“
                        Update Global State
                               â†“
                        Lexer â†’ Parser â†’ Render
                               â†“
                        New HTML
```

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ ĞºĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ğ¸:**

**Static Area:**
```
Ğ£Ğ¶Ğµ Ğ¾Ñ‚Ñ€ĞµĞ½Ğ´ĞµÑ€ĞµĞ½Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚
ĞšÑÑˆĞ¸Ñ€ÑƒĞµÑ‚ÑÑ
ĞĞµ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ
```

**Selected Area:**
```
contenteditable attribute
MutationObserver Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ
Real-time updates
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ contenteditable:**
```
âŒ ĞĞµÑ‚ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ñ… input events (onChange)
âœ… MutationObserver Ğ´Ğ»Ñ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ DOM changes
âœ… Rich text editing
```

---

## 4. ğŸ”¤ Markdown Parser â€” ĞšĞ›Ğ®Ğ§Ğ•Ğ’ĞĞ¯ Ğ§ĞĞ¡Ğ¢Ğ¬! â­

### Component Types (3 ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸):

**1. Visual Components**
```
Functional components
Take data â†’ Render
NO children support

Examples: H1, H2, H3, Paragraph
```

**2. Structural Components**
```
Accept other components as children
Structure the page

Examples: Accordion, Columns, Divider
```

**3. Database Connectable Components**
```
Advanced structural
Accept pages as children
Represent pages in custom views

Examples: Table, Calendar, Timeline
```

---

### Lexer Interface:

```typescript
interface Lexer {
  process(
    rules: Rule[],
    content: string
  ): ComponentToken[];
}
```

**Input:**
- `rules[]` â€” Ğ½Ğ°Ğ±Ğ¾Ñ€ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ» Ğ´Ğ»Ñ Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ°
- `content` â€” markdown ÑÑ‚Ñ€Ğ¾ĞºĞ°

**Output:**
- `ComponentToken[]` â€” Ñ‚Ğ¾ĞºĞµĞ½Ñ‹ (Ğ¾Ğ±ÑŠĞµĞºÑ‚Ñ‹)

---

### Rule Interface:

```typescript
interface Rule {
  // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°: Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ»Ğ¸ ÑÑ‚Ñ€Ğ¾ĞºĞ° Ğ¿Ğ¾Ğ´ ÑÑ‚Ğ¾Ñ‚ rule?
  isValid(line: string): boolean;
  
  // Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ attributes Ğ¸Ğ· ÑÑ‚Ñ€Ğ¾ĞºĞ¸
  getToken(line: string): ComponentToken;
}
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹:**
```
Line: "## Hello World"

H1 Rule:
isValid("## Hello World") â†’ false

H2 Rule:
isValid("## Hello World") â†’ true
getToken("## Hello World") â†’ {
  type: 'h2',
  props: { text: 'Hello World' }
}
```

---

### Component Token Types:

```typescript
// Base token
type ComponentToken<TProps> = {
  type: string;
  props: TProps;
}

// Container (accepts children)
type ContainerComponentToken<TProps> = 
  ComponentToken<TProps> & {
    children: ComponentToken[];  // Nested tokens
  }

// Database component
type DatabaseComponentToken<TProps> = 
  ComponentToken<TProps> & {
    databaseData: DatabaseProps;  // Metadata
  }
```

---

### Syntax Spec (Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹):

```
# H1         â†’ <h1>
## H2        â†’ <h2>
[ ] Checkbox â†’ <input type="checkbox">
--- Divider  â†’ <hr>
```

**Ğ Ğ°ÑÑˆĞ¸Ñ€ÑĞµĞ¼Ğ¾ÑÑ‚ÑŒ:**
```
1. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ rule Ğ² rules[]
2. Rule ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ regex Ğ´Ğ»Ñ Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ°
3. Lexer Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ÑĞµÑ‚
â†’ Ğ›ĞµĞ³ĞºĞ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑÑ‚ÑŒ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹!
```

---

### Parser Interface:

```typescript
interface Parser {
  process(token: ComponentToken): HTMLElement;
}
```

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸ Parser:**
- ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ `ComponentToken`
- ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğº **Global State** (data layer)
- Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒ `HTMLElement`

**Render Set:**
```
Map: ComponentToken â†’ Render Function

{
  'h1': renderH1Function,
  'table': renderTableFunction,
  'checkbox': renderCheckboxFunction
}
```

**Adding New Component:**
```
1. Create component UI
2. Create rule (Lexer)
3. Map token â†’ render function (Parser)
â†’ Done!
```

---

### Full Flow:

```
User types: "## Hello"
    â†“
MutationObserver detects change
    â†“
Dispatch action: UPDATE_CONTENT
    â†“
Action Handler
    â†“
Update Global State (content)
    â†“
Lexer:
  - Rules apply
  - Generate ComponentToken: { type: 'h2', props: { text: 'Hello' } }
    â†“
Parser:
  - Get token
  - Connect to state
  - Call renderH2(token)
    â†“
Render: <h2>Hello</h2>
```

---

## 5. ğŸ—„ï¸ Database Design

### Concept:

**Notion Database:**
```
ĞĞ• relational database!

Database = Page that contains pages
Custom views: Table, Calendar, Timeline
```

**Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°:**
```
Database (Page)
    â†“ has many
Pages Ã— N
    â†“ has
Plugin Data (metadata Ğ´Ğ»Ñ view)
```

---

### Plugin Data:

**Ğ˜Ğ´ĞµÑ:**
```
Page Ğ¸Ğ¼ĞµĞµÑ‚ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ metadata Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ğ½Ñ‹Ñ… views

Page:
  - Timeline Plugin Data: { start, end }
  - Calendar Plugin Data: { date }
  - Table Plugin Data: { columns }
```

**Ğ Ğ°ÑÑˆĞ¸Ñ€ÑĞµĞ¼Ğ¾ÑÑ‚ÑŒ:**
```
ĞĞ¾Ğ²Ğ°Ñ view â†’ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ plugin data
Page Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ view
```

---

### Page Entity:

```typescript
interface Page {
  id: string;
  title: string;
  content?: string;  // Optional (Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¿ÑƒÑÑ‚Ñ‹Ğ¼)
  icon?: string;
  children?: Page[];
  hash?: string;     // Ğ”Ğ»Ñ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ€ĞµĞ½Ğ´ĞµÑ€Ğ°
  
  // Plugin data Ğ´Ğ»Ñ views
  plugins?: {
    timeline?: TimelinePluginData;
    calendar?: CalendarPluginData;
    table?: TablePluginData;
  };
}

// Plugin data types
interface TimelinePluginData {
  start: number;  // timestamp
  end: number;
}

interface CalendarPluginData {
  date: number;   // timestamp
}

interface TablePluginData {
  columns: string[];
}
```

---

### Page View Interface:

```typescript
interface PageView {
  render(pages: Page[]): HTMLElement;
}

// Implementations:
class TimelineView implements PageView { }
class CalendarView implements PageView { }
class TableView implements PageView { }
```

**Ğ’ÑĞµ views â€” Database Components:**
```
Timeline, Calendar, Table â†’ DatabaseComponentToken
â†’ Ğ•Ğ´Ğ¸Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ
â†’ Ğ›ĞµĞ³ĞºĞ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑÑ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğµ views
```

---

## 6. ğŸ—‚ï¸ State Design

```typescript
interface ApplicationState {
  // Root page ID
  rootPageId: string;
  
  // Flattened/Normalized pages
  pages: {
    [pageId: string]: Page;
  };
}
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Normalized:**
```
âœ… O(1) access: pages[id]
âœ… Easy updates: pages[id] = newPage
âœ… No nested structure
âœ… Efficient Ğ´Ğ»Ñ hundreds of pages
```

**Benefits:**
```
ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ page: pages[pageId] â†’ O(1)
Live updates Ğ¾Ñ‚ ÑĞµÑ€Ğ²ĞµÑ€Ğ°: pages[newId] = newPage â†’ ĞŸÑ€Ğ¾ÑÑ‚Ğ¾!
Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ: delete pages[id]
```

---

## 7. ğŸ”Œ API Design

### Protocol Choice:

**Options:**

**1. WebSockets (HTTP/1)**
```
âŒ Complex to scale
âŒ Overkill (Ğ½Ğµ Ğ½ÑƒĞ¶ĞµĞ½ real-time)
âŒ Not HTTP/2 compatible
```

**2. REST API (HTTP/2)**
```
âœ… Simple
âœ… HTTP/2 benefits (caching, parallel)

âŒ Hard to design production-ready
âŒ Hard to change later
âŒ Workarounds Ğ´Ğ»Ñ flexible fields (query params)
```

**3. GraphQL (HTTP/2) â­ Ğ’Ğ«Ğ‘ĞĞ **
```
âœ… Single endpoint
âœ… Flexible (select any fields)
âœ… Long-term maintainability
âœ… Server entity â‰ˆ Client entity â†’ Simplicity

âŒ POST only (no GET caching)
âŒ Need GraphQL client
âŒ Additional point of failure
```

---

### GraphQL API:

```graphql
# Query: Get Page
query GetPage($id: ID!, $apiKey: String!) {
  page(id: $id) {
    id
    title
    content
    icon
    children { id title }
    plugins {
      timeline { start end }
      calendar { date }
    }
  }
}

# Mutation: Update Page (Delta!)
mutation UpdatePage(
  $id: ID!,
  $delta: String!,  # Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ!
  $apiKey: String!
) {
  updatePage(id: $id, delta: $delta) { id }
}

# Subscription: Live Updates (SSE)
subscription SubscribePageChanges(
  $pageId: ID!,
  $apiKey: String!
) {
  pageUpdated(pageId: $pageId) {
    id
    content
    # Changed fields
  }
}
```

**ĞšĞ»ÑÑ‡ĞµĞ²Ğ¾Ğµ:**

**Delta Updates:**
```
ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: Page Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ğ¼
Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ: ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ (ĞºĞ°Ğº Git diff)

External library:
- Calculate diff
- Send delta
- Server applies delta
â†’ Ğ­ĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°!
```

**GraphQL Subscriptions over SSE:**
```
HTTP/2 â†’ Server-Sent Events
GraphQL â†’ Subscriptions (interface)

Implementation:
GraphQL Subscription â†’ SSE transport
â†’ Live collaborative editing support!
```

**GraphQL Client Benefits:**
```
Syncs server state â†” client state
Auto-updates on subscription
Manages cache
```

---

## 8. âš¡ Optimization

### A. Network & JS Performance

**1. HTTP/2 Support**
```
âœ… Parallel connections
âœ… Multiplexing
âœ… Server Push
```

**2. Service Workers (PWA)**
```
Cache all assets
Offline mode âœ…
First load critical
```

**3. Preconnect Ğ´Ğ»Ñ Non-critical**
```html
<link rel="preconnect" href="/analytics.js">
```

**4. ES6+ Bundle**
```
Desktop-first = Modern Chrome
â†’ No polyfills needed!
â†’ Smaller bundle size
```

**5. Bundle Splitting**
```javascript
bundles:
- vendor.js (React, etc.)
- components.js (lazy loaded!)
  - h1.js
  - table.js
  - calendar.js (load Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞºĞ¾Ğ³Ğ´Ğ° Ğ½ÑƒĞ¶ĞµĞ½)
```

**6. Compression**
```
Brotli + Gzip
```

**7. Image Optimization**
```
WebP format
Image optimization service:
  - Resize
  - Convert PNG â†’ WebP
  - Save CDN space
```

---

### B. Rendering Performance

**CSS:**
```
âœ… Avoid reflows
âœ… CSS animations (GPU)
âœ… CSS naming strategy (BEM, Tailwind)
âœ… Flat selectors
```

**DOM:**
```
âœ… Minimize re-renders
âœ… Track changes Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ² Selected Area (MutationObserver)
âœ… Parsing cache (re-use tokens)
âœ… Component virtualization (Table)
```

**UX:**
```
React/Vue/Angular Ğ´ĞµĞ»Ğ°ÑÑ‚ optimization Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸
(ĞĞ¾ design framework-agnostic)
```

---

## 9. â™¿ Accessibility

**1. Use REM units**
```css
/* Scales with browser zoom */
font-size: 1rem;
```

**2. Hotkeys**
```
Notion = hotkey champion
Design later (too many!)
```

**3. Color Schemas**
```
Support visual disabilities
High contrast modes
Color blindness themes
```

**4. Semantic HTML**
```html
<!-- âœ… Use correct tags -->
<table> Ğ´Ğ»Ñ tables
<input> Ğ´Ğ»Ñ inputs

<!-- âŒ Don't -->
<div> everywhere
```

**5. Alt Attributes**
```html
<img alt="AI-generated description">
```

**ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ¾:**
```
HTML accessible by default
Use native elements
Minimize custom components
```

---

## ğŸ“Š Event-Driven Architecture

```
Component
    â†“ User Action
Global Dispatcher (available everywhere)
    â†“ Route Action
Action Handler
    â†“ Process
Update Global State
    â†“ State Changed
Components Re-render (subscribed)
```

**Implementation:**
```
Redux (React)
Vuex (Vue)
NgRx (Angular)
```

---

## ğŸ“ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ñ‹

### 1. **Extendable Components Library**
```
3 types: Visual, Structural, Database
Unified interface
Easy to add new components
```

### 2. **Custom Markdown Parser**
```
Lexer: Markdown â†’ Tokens
Parser: Tokens â†’ HTML + State
Render Set: Token â†’ Render Function

Add component:
1. Create rule
2. Map render function
â†’ Done!
```

### 3. **Database = Pages + Plugin Data**
```
Database = Page
Pages have plugin metadata
Easy to add new views
```

### 4. **GraphQL + Delta Updates**
```
Flexible queries
Delta = only changes
SSE subscriptions
```

### 5. **Offline-first**
```
Service Workers
Cache assets
PWA mode
```

### 6. **contenteditable + MutationObserver**
```
Real-time editing
No standard input events
MutationObserver tracks DOM
```

### 7. **Normalized State**
```
Flattened: { [id]: Page }
O(1) access
Easy updates
```

---

**Ğ’Ñ€ĞµĞ¼Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ:** ~60 Ğ¼Ğ¸Ğ½ÑƒÑ‚  
**Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ:** Senior/Staff Frontend Engineer  
**ĞšĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸:** Notion, Coda, Obsidian, Roam Research

Ğ£Ğ´Ğ°Ñ‡Ğ¸ Ğ½Ğ° Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²ÑŒÑ! ğŸ“ğŸš€